<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>EduLearn | Plateforme e-learning</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script defer src="assets/js/main.js"></script>
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>

<body>

    <!-- ===== HEADER ===== -->
    <header class="header">
        <a href="index.html" class="logo" style="text-decoration: none;">Edu<span>Learn</span></a>

        <form class="search-bar" action="recherche.html" method="GET">
            <input type="text" name="q" placeholder="Rechercher un cours..." required>
            <button type="submit">
                <i class='bx bx-search'></i>
            </button>
        </form>

        <nav class="nav">
            <a href="cours/listecours.html" class="btn-cours">Cours</a>
            <a href="enseignant.html" class="btn-e">Enseignants</a>
            <a href="tarifs.html" class="btn-tarifs">Abonnements</a>
            <a href="contact/contact.html" class="btn-contact">Contact</a>
            <a href="auth/login.html" class="btn-login">Se connecter</a>
            <!-- TODO Node.js : afficher login/logout selon session -->
        </nav>
    </header>

    <!-- ===== HERO ===== -->
    <section class="hero">
        <div class="hero-text">
            <h1>Apprenez sans limites</h1>
            <p>
                Atteignez vos objectifs académiques et professionnels avec EduLearn,
                la plateforme e-learning dédiée aux étudiants en informatique.
            </p>
            <p>Des cours en ligne pour renforcer vos compétences techniques.</p>
            <a href="cours/listecours.html" class="btn-primary">Explorer les cours</a>
        </div>

        <div class="hero-img">
            <img src="assets/image/illustration.png" alt="Illustration apprentissage en ligne">
        </div>
    </section>

    <!-- ===== COURS POPULAIRES ===== -->
    <section class="courses">
        <h2>Cours les plus populaires</h2>

        <div class="course-grid" id="popular-courses">
            <!-- Les cours seront générés dynamiquement ici -->
            <p>Chargement des cours populaires...</p>
        </div>
    </section>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
        <p>© 2026 EduLearn – Plateforme e-learning</p>
    </footer>

    <script>
        // Configuration
        const API_URL = 'http://localhost:3000/api';

        // Helper pour les appels API
        async function apiCall(endpoint) {
            try {
                const response = await fetch(`${API_URL}${endpoint}`);
                return await response.json();
            } catch (error) {
                console.error(error);
                return null;
            }
        }

        async function loadPopularCourses() {
            const response = await apiCall('/courses');

            if (response && response.data) {
                // On prend les 3 premiers cours comme "populaires" pour l'instant
                const popularCourses = response.data.slice(0, 3);
                displayPopularCourses(popularCourses);
            } else {
                document.getElementById('popular-courses').innerHTML = '<p>Impossible de charger les cours.</p>';
            }
        }

        function displayPopularCourses(courses) {
            const container = document.getElementById('popular-courses');

            if (!courses || courses.length === 0) {
                container.innerHTML = '<p>Aucun cours disponible.</p>';
                return;
            }

            container.innerHTML = courses.map(course => {
                const teacherName = typeof course.teacher === 'object'
                    ? `${course.teacher.firstName} ${course.teacher.lastName}`
                    : 'Enseignant';

                return `
            <a href="cours/cours.html?id=${course._id}" class="course-card">
                <h3>${course.title}</h3>
                <p>${course.description ? course.description.substring(0, 100) + '...' : 'Pas de description'}</p>
                <div class="course-meta">
                     <span><i class='bx bxs-user'></i> ${teacherName}</span>
                </div>
                <span class="btn-small" style="margin-top: 15px; display:inline-block; text-align:center;">Voir le cours</span>
            </a>
            `;
            }).join('');
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', loadPopularCourses);
    </script>

</body>

</html>